server {
  listen 80 default_server;
  listen [::]:80 default_server;

  location = /lock/open {
    auth_basic "Restricted access";
    auth_basic_user_file /etc/nginx/conf.d/.htpasswd;

    proxy_pass http://rpi-relay-controller:8080/lock/open;
  }

  location /controller/ {
    auth_basic "Restricted access";
    auth_basic_user_file /etc/nginx/conf.d/controllers.htpasswd;

    proxy_pass http://rpi-relay-controller:8080/api/;
  }

  location /api/ {
    proxy_pass https://{TIMEFLOW_PREFIX_SERVER}.timeflow.one/api/;
  }

  location / {
    auth_basic "Restricted access";
    auth_basic_user_file /etc/nginx/conf.d/console.htpasswd;

    alias /var/www/page/;
    try_files $uri $uri/ /index.html;
  }
}
